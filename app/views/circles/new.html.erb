<div data-role="header">
    <h1>Ny cirkel</h1>
</div>
<div data-role="content" data-theme="b" class="ui-body-c">
    <%= form_for @circle, :'data-ajax' => "false" do |f| %>
        <% if @circle.errors.any? %>
        <div id="error_explanation">
            <h2><%= pluralize(@circle.errors.count, "error") %> prohibited this circle from being saved:</h2>

            <ul>
            <% @circle.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
            <% end %>
            </ul>
        </div>
        <% end %>

        <div data-role="fieldcontain">
            <%= f.label :title, "Titel" %>
            <%= f.text_field :title, :'data-theme' => "d" %>
        </div>

        <div data-role="fieldcontain">
            <%= f.label :public, "Publik cirkel?" %>
            <%= f.select :public, options_for_select([["Hemlig", 0], ["Publik", 1]], 1), {}, :'data-role' => "slider" %>
        </div>

        <div data-role="fieldcontain">
            <p class="bottom-space">Lägg till personer</p>
            <ul data-role="listview" data-filter="true" data-filter-placeholder="Sök personer..." data-filter-theme="c" data-theme="c">
                <% @users_grouped.each do |letter, users| %>
                    <li data-role="list-divider"><%= letter %></li>
                    <li>
                    <% users.each do |user| %>
                        <%= check_box_tag "circle[circle_memberships_attributes][][user_id]", user.id, @circle.circle_memberships.include?(user) || user == current_user, :id => "circle_membership_#{user.id}" %>
                        <%= label_tag "circle_membership_#{user.id}", user.name %>
                    <% end %>
                    </li>
                <% end %>
            </ul>
        </div>

        <div class="actions top-space">
            <%= f.submit "Skapa cirkel", :'data-theme' => "b" %>
        </div>
    <% end %>
</div>